# 心理测试反馈报告生成器 V1.0.2

## 📋 软件简介

**心理测试反馈报告生成器 V1.0.2** 是一款专业的**通用数据分析工具**，能够自动读取Excel数据文件，生成包含高质量雷达图的个性化PDF报告。

### 🌟 核心特性

- **🔧 完全通用化设计** - 支持任意测评项目和评价标准
- **📊 智能雷达图生成** - 300 DPI高清输出，专业视觉效果
- **📄 自动PDF报告** - 一键生成完整的分析报告
- **📝 自定义文件名** - 支持ID号或姓名+自定义内容的灵活命名方式
- **⚙️ 灵活配置系统** - 通过Excel文件自定义所有参数
- **🎯 智能数据处理** - 自动识别数据格式和评价规则
- **🚀 批量处理支持** - 高效处理多个测试对象
- **🎨 中文字体完美支持** - 专业的中文排版效果
- **📝 自定义结果说明** - 支持用户自定义结果说明文本内容

### 💡 适用场景

本软件适用于各种需要数据可视化和报告生成的场景：

- **心理测评** - 认知能力、情绪状态、行为特征等
- **教育评估** - 学习能力、知识掌握、技能水平等  
- **职业测评** - 能力素质、性格特征、职业倾向等
- **健康评估** - 身体指标、康复进度、风险评估等
- **绩效考核** - 工作表现、技能评级、发展潜力等
- **市场调研** - 满意度调查、产品评价、用户画像等

## 🚀 快速开始

### 系统要求

- Windows 10/11 (64位)
- 4GB RAM
- 100MB 可用磁盘空间
- **无需安装Python环境**

### 下载与安装

1. **下载软件包**
   - 从 [GitHub Releases](https://github.com/W-psy/Psychological-test-report-generator/releases) 下载最新版本
   - 下载 `PsychTestReportGenerator-v1.0.2-Windows.zip`

2. **解压软件包**
   ```
   解压到任意目录（建议：D:\心理测试报告生成器\）
   ```

3. **启动程序**
   - 双击 `PsychTestReportGenerator1.0.2.exe` 文件
   - 首次运行可能需要几秒钟加载时间

### 📁 软件包内容

解压后的文件夹包含：
- `PsychTestReportGenerator1.0.2.exe` - 主程序（双击运行）
- `config.json` - 配置文件
- `templates/` - Excel模板文件夹
- `logs/` - 日志文件夹
- `README.md` - 使用说明
- `快速使用指南.md` - 快速入门指南

## 📖 使用指南

## 📊 数据文件格式要求

### Excel数据文件格式

您的Excel数据文件需要包含以下信息：

**基本信息列（前6列，固定顺序，字段名称必须完全匹配）：**

**重要说明：前6列的字段名称是硬编码的，必须严格按照以下名称和顺序设置：**

1. **姓名** - 测试对象的姓名（字段名必须为"姓名"）
2. **性别** - 性别信息（字段名必须为"性别"）  
3. **生日** - 出生日期（字段名必须为"生日"）
4. **年龄** - 年龄信息（字段名必须为"年龄"）
5. **测试日期** - 测试进行的日期（字段名必须为"测试日期"）
6. **ID** - 唯一标识符（字段名必须为"ID"）

**注意事项：**
- 这6个字段名称不可修改，必须完全匹配（区分大小写）
- 顺序可以调整，但建议按上述顺序排列
- 如果某个字段暂时没有数据，可以留空，但列名必须存在

**测评数据列（必需）：**
- 各项测评指标的数值分数（如：项目A、项目B、项目C等）
- 分数范围建议：0-200分（软件会自动适配不同的分数范围）

### Excel配置文件格式

配置文件用于定义评价标准，支持多种分档模式：

**2档模式（4列）：**
```
测评项目    | 阈值1  | 低分说明        | 高分说明
| 项目A    | 85     | 基础水平描述    | 优秀水平描述 |
```

**3档模式（6列）：**
```
测评项目    | 阈值1  | 阈值2  | 低分说明    | 中等分说明    | 高分说明
| 项目A    | 85     | 115    | 基础水平    | 良好水平      | 优秀水平 |
```

**4档模式（8列）：**
```
测评项目    | 阈值1  | 阈值2  | 阈值3  | 很低说明  | 低分说明  | 中等分说明  | 高分说明
```

**5档模式（10列）：**
```
测评项目    | 阈值1  | 阈值2  | 阈值3  | 阈值4  | 很低说明  | 低分说明  | 中等分说明  | 高分说明  | 很高说明
```

**6档模式（12列）：**
```
测评项目    | 阈值1  | 阈值2  | 阈值3  | 阈值4  | 阈值5  | 极低说明  | 低分说明  | 中低说明  | 中高说明  | 高分说明  | 极高说明
```

**7档模式（14列）：**
```
测评项目    | 阈值1  | 阈值2  | 阈值3  | 阈值4  | 阈值5  | 阈值6  | 极低说明  | 低分说明  | 中低说明  | 中等说明  | 中高说明  | 高分说明  | 极高说明
```

### 示例数据

**数据文件示例：**
| 姓名 | 性别 | 生日 | 年龄 | 测试日期 | ID | 项目A | 项目B | 项目C | 项目D |
|------|------|------|------|----------|-----|-------|-------|-------|-------|
| 张三 | 男   | 20000101 | 25   | 20240101 | ZS001 | 85    | 92    | 78    | 88    |

**配置文件示例：**
| 测评项目 | 阈值1 | 阈值2 | 低分说明 | 中等分说明 | 高分说明 |
|----------|-------|-------|----------|------------|----------|
| 项目A | 85    | 115   | 基础水平 | 良好水平   | 优秀水平 |
| 项目B | 85    | 115   | 需要提高 | 表现良好   | 表现优秀 |

### 操作步骤

1. **启动程序**
   - 双击 `PsychTestReportGenerator1.0.2.exe` 启动软件
   - 等待程序界面加载完成

2. **选择数据文件**
   - 点击"选择Excel文件"按钮
   - 选择包含测评数据的Excel文件
   - 支持 `.xlsx` 和 `.xls` 格式

3. **选择配置文件**
   - 点击"选择配置文件"按钮
   - 选择对应的评分模式配置文件
   - 可使用软件包内 `templates/` 文件夹中的模板

4. **设置文件命名方式**
   - 选择文件命名模式：
     - **ID[自定义内容]报告**：使用ID号+自定义内容，如 `ZS001心理测评报告.pdf`
     - **姓名[自定义内容]报告**：使用姓名+自定义内容，如 `张三心理测评报告.pdf`
   - 在自定义内容框中输入分隔符（如：心理测评、能力评估等）
   - 实际生成的文件名会直接连接，不包含方括号

5. **选择输出目录**
   - 点击"选择输出目录"按钮
   - 选择报告保存位置

6. **生成报告**
   - 点击"生成报告"按钮
   - 等待处理完成（进度条显示处理状态）

7. **查看结果**
   - 在输出目录查看生成的PDF报告
   - 每个测评对象对应一个PDF文件
   - 文件名格式根据您的设置自动生成

### 雷达图说明

- **蓝色区域**：个人测评结果
- **红色虚线**：100分基准线
- **网格线**：分数刻度参考
- **变量标签**：各项能力维度名称

## ⚙️ 配置选项

### 基本配置

程序支持以下配置项（在 `config.json` 中）：

```json
{
    "default_variables": [
        ""
    ],
    "baseline_score": 100,
    "chart_dpi": 300,
    "output_format": "pdf"
}
```

### 样式自定义

可以通过修改 `radar_chart.py` 中的 `style_config` 来自定义：
- 颜色方案
- 线条粗细
- 字体大小
- 透明度等

## 🔧 故障排除

### 常见问题

**Q: 程序启动失败或闪退**
A: 
- 确保系统为Windows 10/11 64位
- 检查是否被杀毒软件误报，添加到白名单
- 尝试以管理员身份运行
- 确保有足够的磁盘空间和内存

**Q: 程序启动很慢**
A: 
- 首次运行需要解压内部文件，请耐心等待
- 后续启动会更快
- 建议将软件放在SSD硬盘上

**Q: Excel文件读取失败**
A: 
- 确保文件格式为 `.xlsx` 或 `.xls`
- 检查前6列基本信息字段名称是否正确
- 确保数据从第7列开始为测评项目
- 关闭Excel文件后再进行处理

**Q: 雷达图显示异常**
A: 
- 检查数据是否包含有效的数值
- 确保配置文件格式正确
- 检查阈值设置是否合理

**Q: PDF生成失败**
A: 
- 确保输出目录有写入权限
- 检查磁盘空间是否充足
- 确保输出路径不包含特殊字符

### 日志文件

程序运行日志保存在软件目录下：
- `logs/app_YYYYMMDD.log`
- 出现问题时请查看日志文件获取详细错误信息

## ❓ 常见问题

### Q: 为什么前6列字段名称不能修改？
A: 软件内部对前6列基本信息字段进行了硬编码处理，这些字段名称（姓名、性别、生日、年龄、测试日期、ID）必须严格匹配。第7列开始的测评项目字段名称可以自由定义。

### Q: 如果我的数据文件字段名称不匹配怎么办？
A: 请修改Excel文件的列标题，确保前6列的字段名称完全匹配要求。例如，如果您的文件中是"Name"，请改为"姓名"。

### Q: 基本信息字段可以留空吗？
A: 可以。如果某个基本信息字段暂时没有数据，可以留空，但列名必须存在。软件会自动用"-"或默认值填充空白字段。

### Q: 字段顺序重要吗？
A: 前6列基本信息字段的顺序可以调整，但建议按照文档中的顺序排列以保持一致性。第7列开始的测评项目字段顺序不限制。

## 📞 技术支持

如有问题或建议，请通过以下方式联系：

- 🐛 **问题反馈**：[GitHub Issues](https://github.com/W-psy/Psychological-test-report-generator/issues)
- 📖 **使用文档**：查看软件包内的 `README.md` 和 `快速使用指南.md`
- 💡 **功能建议**：欢迎在GitHub Issues中提出改进建议
- 📋 **使用交流**：可在Issues中分享使用经验和技巧

### 🆘 获取帮助

遇到问题时，请提供以下信息以便快速解决：
1. 软件版本号（当前：v1.0.1）
2. 操作系统版本
3. 具体错误信息或截图
4. 日志文件内容（`logs/app_YYYYMMDD.log`）

## 📝 更新日志

### V1.0.2 (2025-07-22)
- ✅ **自定义文件名功能** - 新增灵活的PDF文件命名方式，支持ID号或姓名+自定义内容格式
- ✅ **优化用户界面** - 改进GUI界面，增加文件命名设置区域，提升用户体验
- ✅ **智能命名逻辑** - 实现智能文件命名算法，避免文件名冲突，支持批量处理
- ✅ **增强配置管理** - 优化配置文件处理逻辑，提升程序稳定性
- ✅ **完善文档说明** - 更新使用指南，详细说明新功能的使用方法

### V1.0.1 (2025-07-22)
- ✅ **扩展评分模式支持** - 新增6档和7档评分模式，支持12列和14列Excel配置文件格式
- ✅ **新增极值标签** - 支持"极低"和"极高"级别标签，提供更精细的评价维度
- ✅ **创建模板文件** - 提供6档和7档Excel配置模板文件，便于用户快速配置
- ✅ **自定义结果说明** - 新增自定义结果说明文本功能，支持用户个性化设置
- ✅ **完善配置管理** - 优化配置文件加载逻辑，增强验证机制
- ✅ **文档更新** - 完善使用指南和配置说明文档

### V1.0.0 (2025-07-21)
- ✅ 初始版本发布
- ✅ 支持Excel数据读取
- ✅ 高质量雷达图生成
- ✅ PDF报告自动生成
- ✅ 智能基准线定位
- ✅ 300 DPI高清输出
- ✅ 中文字体完美支持

## 📄 许可证

本软件仅供学习和研究使用。

---

**心理测试反馈报告生成器 V1.0.2**  
*让心理测评数据可视化更简单*